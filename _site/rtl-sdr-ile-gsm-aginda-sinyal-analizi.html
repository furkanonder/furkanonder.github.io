<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta charset="utf-8">
<link href="/assets/css/bootstrap.min.css" rel="stylesheet">
<link href="/assets/css/ie10-viewport-bug-workaround.css" rel="stylesheet">
<link href="/assets/css/custom.css" rel="stylesheet">
<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Rtl-Sdr ile GSM Ağında Sinyal Analizi | Furkan Önder</title>
<meta name="generator" content="Jekyll v3.6.3" />
<meta property="og:title" content="Rtl-Sdr ile GSM Ağında Sinyal Analizi" />
<meta name="author" content="furkan önder" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="rtl-sdr kullanarak GSM ağında sinyal analizi" />
<meta property="og:description" content="rtl-sdr kullanarak GSM ağında sinyal analizi" />
<link rel="canonical" href="http://localhost:4000/rtl-sdr-ile-gsm-aginda-sinyal-analizi" />
<meta property="og:url" content="http://localhost:4000/rtl-sdr-ile-gsm-aginda-sinyal-analizi" />
<meta property="og:site_name" content="Furkan Önder" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-08-11T12:00:00+03:00" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"furkan önder"},"description":"rtl-sdr kullanarak GSM ağında sinyal analizi","@type":"BlogPosting","headline":"Rtl-Sdr ile GSM Ağında Sinyal Analizi","dateModified":"2019-08-11T12:00:00+03:00","datePublished":"2019-08-11T12:00:00+03:00","url":"http://localhost:4000/rtl-sdr-ile-gsm-aginda-sinyal-analizi","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/rtl-sdr-ile-gsm-aginda-sinyal-analizi"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>
<body>
  <div class="container">
    <div class="navbar navbar-default navbar-fixed-top">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://furkanonder.github.io/">furkanönder</a>
    </div>
    <div class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li><a href="https://furkanonder.github.io/">Anasayfa</a></li>
        <li><a href="/hakkimda/">Hakkımda</a></li>
        <li><a href="/arsiv/">Arşiv</a></li>
      </ul>
    </div>
  </div>
</div>

<div id="ust" class="row">
  <div class="col-md-12">
    <div class="panel panel-info">
      <div class="panel-heading">
        <h3 class="text-primary">Rtl-Sdr ile GSM Ağında Sinyal Analizi</h3>
        <span class="text-muted">
          <time datetime="11 August 2019">
            11 Ağustos 2019
          </time>
      	</span>
      </div>

      <div class="panel-body">
        <p>Selamlar,</p>

<p>Rtl-sdr ile uğraşırken sinyal aralağının çok geniş olduğu aklıma geldi.500kHz ile 1.75 GHz frekans aralağını dinleyebiliyorsunuz.Sonra cep telefonlarınımızda kullandığımız GSM teknolojisinin bu frekans aralığına girebileceğini düşündüm ve giriyormuş :) Biraz araştırma yaptıktan sonra bu konuda yapılmış çalışmalara göz attım.Öğrendiklerimi ve tecrübelerimi bu yazıda yazmaya karar verdim.</p>

<p>Rtl-sdr ne derseniz, sdr kelimesinin açılımı “Software Defined Radio” (yazılım tabanlı radyo).Yazılımla kolayca kontrol edilebilmesi ve geniş bir frekans aralığına sahip olduğu için kullanışlı olmasından dolayı çok popüler.Fm radyo dinleyebiliyorsunuz,üzerinizden geçen uydulardan sinyal alabiliyorsunuz, TV yayını alabiliyorsunuz ve daha bir çok amaç için kullanabiliyorsunuz.</p>

<h2 id="gelelim-gsme">Gelelim GSM’e</h2>
<p>GSM ağına rtl-sdr ile nasıl dahil olabiliriz,sinyal alabiliriz? <a href="https://www.gimp.org/">Gimp</a> ile işe güzel bir çizim yaparak anlatmayı düşündüm :)</p>

<p><a href="/assets/images/gsm/baz.png" imageanchor="1">
  <img style="display: block;margin: 0 auto;width: 33em;" src="/assets/images/gsm/baz.png" />
</a></p>

<p>Kırmızı ve mavi olan kuleler  çevremizdeki gerçek baz istasyonlarımız olsun. Mor olan kutumuz ise rtl-sdr ile yaptığımız sahte baz istayonumuz olsun.Yakınımızdaki cep telefonlarına kendimizi baz istasyonu olarak tanıtıp onlardan veri alacağız.</p>

<h2 id="nelere-ihtiyacımız-var">Nelere ihtiyacımız var?</h2>
<p><a href="/assets/images/gsm/rtl-sdr.jpg" imageanchor="1">
  <img style="display: block;margin: 0 auto;width: 33em;height:500px;width:500px;" src="/assets/images/gsm/rtl-sdr.jpg" />
</a></p>

<h3 id="donanım">Donanım</h3>
<ul>
  <li>Rtl-Sdr</li>
</ul>

<p>Yukarıda resimde kullandığım rtl-sdr ‘a görüyorsunuz.RTL2832u entegresine sahip herhangi bir rtl-sdr kullabilirsiniz.Yurt içindeki ve dışındaki internet siteleri üzerinde satılıyor.</p>

<h3 id="yazılım">Yazılım</h3>
<ul>
  <li><a href="https://www.wireshark.org/">Wireshark</a> – Paketlerimizi incelemek için kullanacağız.</li>
  <li><a href="https://github.com/ptrkrysik/gr-gsm">Gr-gsm</a> – Sinyallerimizi yakalamak için kullancağız.</li>
  <li><a href="https://github.com/steve-m/kalibrate-rtl">kalibrate-rtl</a> – Rtl-sdr’ın kalibrasyonunu için kullanacağız.</li>
  <li><a href="https://github.com/Oros42/IMSI-catcher">IMSI-catcher</a> –  IMSI verilerini bize gösteren bir python betiği.</li>
  <li>Gnu/Linux tabanlı bir işletim sistemi(Windows üzerinde bu işlemler yapılabiliyor ama ben bütün denemeleri Gnu/Linux tabanlı bir işletim sisteminde denedim)</li>
</ul>

<h2 id="hadi-başlayalım">Hadi Başlayalım</h2>
<p>Öncelikle işe rtl-sdr’imızın kalibrasyonu yapmak ile başlıyoruz.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kal -s GSM900 -g 40
</code></pre></div></div>
<p>komutunu çalıştırıyoruz.</p>

<p>GSM standardında ihtiyaca göre frekans aralıklarına bölünmüş GSM için radyo frekansları vardır.GSM900 bunlardan en yaygını olan olduğu için ilk parametremiz bu olacak. Yapacağımız aramanın dbi aralığını ise 40 olarak olarak ayarladık.</p>

<p><a href="/assets/images/gsm/kal.png" imageanchor="1">
  <img style="display: block;margin: 0 auto;width: 33em;" src="/assets/images/gsm/kal.png" />
</a></p>

<p>Farklı kanal ve frekans aralıklarına kullanan bir çok bilgiye sahibiz.Bu bilgileri elde ettiğimize göre artık paket almaya başlayabiliriz.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gr_gsm livemon
</code></pre></div></div>
<p>komutunu çalıştırıyoruz.
Sağ tarafta frequency bölümene gelip daha önce kalibre ettiğimizde elde ettiğimiz frekanslardan birini yazıyoruz.Sol kısımdaki gibi gelen verileri görüyorsanız doğru yoldasınız demektir.</p>

<p><a href="/assets/images/gsm/grgsm.png" imageanchor="1">
  <img style="display: block;margin: 0 auto;width: 33em;" src="/assets/images/gsm/grgsm.png" />
</a></p>

<p>Şimdi gelen verilerimizi analiz etmek için wireshark aracımızı açıyoruz.Capture bölümden Loopback:lo ‘yu seçiyoruz.</p>

<p>Ben Wireshark’ı çalıştırdığımda LAPDm ve GSMTAP şeklinde 2 protokol üzerinden veri aldım.LAPDm, GSM şebekelerinde kullanılan bir veri bağlantı katmanı protokolüdür. Hücresel şebeke ile abone arasındaki telsiz bağlantısında kullanılıyor.GSMTAP ise wireshark tarafından kullanan GSM  arayüzünden çerçeveler taşımak için kullanılan sahte bir başlık.</p>

<p>Protokoller üzerinden elde ettiğim paket başlıkları;</p>

<p>GSMTAP:</p>
<ul>
  <li>Paging Request Type 1,2,3,4</li>
  <li>System Information Type 3,4,13,2quarter</li>
  <li>Immediate Assingment</li>
</ul>

<p>LAPDm:</p>
<ul>
  <li>System Information Type 5,6</li>
  <li>Authentication Request</li>
  <li>Ciphering Mode Command</li>
  <li>Identity Request</li>
</ul>

<h2 id="gelelim-paketleri-incelemeye">Gelelim paketleri incelemeye….</h2>
<p>GSMTAP protokolü System Information Type 4 paketini inceliğimizde Local Area Identification( Konum Alanı Kimliği) kısmı gözümü çarpıyor.</p>

<p>Local Area Identification (Konum Alanı Kimliği), bir mobil ağ içindeki bir konum alanını (LA) benzersiz şekilde tanımlar. Mobil Ülke Kodu (MCC), Mobil Şebeke Kodu (MNC) ve Konum Alan Kodu’ndan (LAC) oluşur. LAI, ağdaki mobil aboneleri takip etmek için kullanılır. Bu kayıt, GSM şebekesindeki Visitor Location Register  (Ziyaretçi Yer Kaydı)  gibi bir veri tabanında tutuluyor.</p>

<p><a href="/assets/images/gsm/lai.png" imageanchor="1">
  <img style="display: block;margin: 0 auto;width: 33em;" src="/assets/images/gsm/lai.png" />
</a></p>

<p>Yukarıda resimde bunları görebiliyoruz. MCC kodu Türkiye için 286, MNC kodu ise GSM  operatörlerin ülke içerisinde kullandığı kod,örneğin Turkcell için 01.LAC kodu ise GSM operatörünün verdiği Konum Alanı Kimliği.</p>

<p><a href="/assets/images/gsm/encrpytion.png" imageanchor="1">
  <img style="display: block;margin: 0 auto;width: 33em;" src="/assets/images/gsm/encrpytion.png" />
</a></p>

<p>GSMTAP protokolü  üzerinde Ciphering Mode Command Identification kısmını  görüyoruz.Tahmin ettiğimiz gibi GSM üzerindeki haberleşmemizi güvenli kılan yapılardan biri.A5/3 algorithması kullanılarak verilerimiz şifreleniyor.Hemen aklınıza gelebilir bu şifrelemeyi çözebilirmiyiz? Internet üzerinde şifrelemeyi çözmeyi gösteren video ve yazılar var.</p>

<p><b>Not:</b> A5/3 algorithması kırmayı denediğiniz takdirde olacaklardan sorumlu değilim.Bu yazıdaki amacım GSM teknolojisinin hakkında biraz bilgi edinmek.</p>

<h2 id="imsi-catcheryakalayıcı">IMSI Catcher(Yakalayıcı)</h2>
<p>International Mobile Subscriber Identity (Uluslararası mobil abone kimliği) hücresel bir ağın her kullanıcısını benzersiz şekilde tanımlayan bir sayıdır. Gizli dinleyicilerin telsiz arabirimindeki aboneyi tanımlamasını ve izlemesini önlemek için IMSI nadiren gönderiliyor ve bunun yerine rastgele oluşturulmuş bir TMSI gönderiliyor.</p>

<p><a href="https://github.com/Oros42/IMSI-catcher">IMSI-catcher</a> içerisinde bulunan  simple_IMSI-catcher.py betiğini çalıştıralım.</p>

<p><a href="/assets/images/gsm/imsi.png" imageanchor="1">
  <img style="display: block;margin: 0 auto;width: 33em;" src="/assets/images/gsm/imsi.png" />
</a></p>

<p>Bu betik işimizi kolaylaştırıyor Wireshark’ da paketleri tek tek incelemek yerine bu betiği kullanarak kolayca bilgi edinebiliyoruz. MMC,NNC ve LAC kavramlarının anlamlarından bahsetmiştim.Buna ek olarak burada Ülke,GSM operatörü adı,CellId, IMSI ve TMSI bilgilerini de görüyoruz.</p>

<p>IMSI ise şöyle elde ediliyor;</p>

<ul>
  <li>
    <p>İlk 3 rakam: 
Mobil Calling Code(Mobil Ülke Kodu),Türkiye için 286.</p>
  </li>
  <li>
    <p>Ortaki 2 rakam: 
Mobil Network Code (Mobil Şebeke Kodu), GSM operatörlerin ülke içerisinde kullandığı kod,örneğin Turkcell için 01.</p>
  </li>
  <li>
    <p>Son 10 rakam:
Mobile identification number (Mobil Tanımlama Kodu),GSM operatörünün kendisinin belirlediği bir değer.</p>
  </li>
</ul>

<p>Biraz uzun bir yazı oldu.Umarım hoşunuza gitmiştir.İyi çalışmalar.</p>

<h2 id="referanslar">Referanslar</h2>
<ul>
  <li>https://en.wikipedia.org/wiki/GSM</li>
  <li>https://en.wikipedia.org/wiki/International_mobile_subscriber_identity</li>
  <li>https://en.wikipedia.org/wiki/IMSI-catcher</li>
</ul>

      </div>

      <div class="panel-footer">
        <ul class="pager panel-info">
          
          <li class="next">
            <a href="/tor-relay-kurulumu" data-toggle="tooltip" data-placement="top" title="C kodunu gdb ile disassemble etmek">Önceki Gönderi &rarr;</a>
          </li>
          
          
          <li class="previous">
            <a href="/C-kodunu-gdb-ile-disassemble-etmek" data-toggle="tooltip" data-placement="top" title="Tor Relay Kurulumu">&larr; Sonraki Gönderi</a>
          </li>
          
          <div class="post-date"></div>
          <div class="sharing-icons">
            <div class="post-date">Sosyal Medyada Paylaş!</div>
          	<a href="https://twitter.com/intent/tweet?text=Rtl-Sdr ile GSM Ağında Sinyal Analizi&amp;url=/rtl-sdr-ile-gsm-aginda-sinyal-analizi" target="_blank"><i class="fa fa-twitter fa-2x" aria-hidden="true"></i></a>
            <a href="https://www.facebook.com/sharer/sharer.php?u=/rtl-sdr-ile-gsm-aginda-sinyal-analizi&amp;title=Rtl-Sdr ile GSM Ağında Sinyal Analizi" target="_blank"><i class="fa fa-facebook fa-2x" aria-hidden="true"></i></a>
            <a href="https://plus.google.com/share?url=/rtl-sdr-ile-gsm-aginda-sinyal-analizi" target="_blank"><i class="fa fa-google-plus fa-2x" aria-hidden="true"></i></a>
          </div>
        </ul>
      </div>
    </div>

    
    <div class="panel panel-info">
      <div class="panel-body">
        
<div class="comments">
  <div id="disqus_thread"></div>
	<script>
	(function() {
	var d = document, s = d.createElement('script');
	s.src = 'https://furkantahaonder.disqus.com/embed.js';
	s.setAttribute('data-timestamp', +new Date());
	(d.head || d.body).appendChild(s);
	})();
	</script>
	<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>


      </div>
    </div>
    
  </div>

  <div class="row2">
    <div class="col-md-12">
      <div class="panel panel-danger">
        <div class="panel-heading">
          <span class="text-primary"><b>Son Gönderiler</b></span>
        </div>
        <div class="panel-body">
          <ul>
            
            <li>
              <a href="/C-kodunu-gdb-ile-disassemble-etmek">C kodunu gdb ile disassemble etmek</a>
            </li>
            
            <li>
              <a href="/rtl-sdr-ile-gsm-aginda-sinyal-analizi">Rtl-Sdr ile GSM Ağında Sinyal Analizi</a>
            </li>
            
            <li>
              <a href="/tor-relay-kurulumu">Tor Relay Kurulumu</a>
            </li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>

</div>


  </div>
  <footer class="footer">
  <div class="container footerBox">
    <p class="copyright text-muted">
      &#169; 2018 Furkan Önder.Powered by Github Pages and Jekyll.
      <a href="https://github.com/furkanonder" target="_blank"><i style="font-size:28px; color:White" class="fa fa-github" ></i></a>
      <a href="https://twitter.com/Fsyscall" target="_blank"><i style="font-size:28px; color:White" class="fa fa-twitter" ></i></a>      
      <a href="https://www.linkedin.com/in/furkan-onder/" target="_blank"><i style="font-size:28px; color:White" class="fa fa-linkedin" ></i></a>
      <a href="https://medium.com/@furkanonder/" target="_blank"><i style="font-size:28px; color:White" class="fa fa-medium" ></i></a>
      <a href="/feed.xml" target="_blank"><i style="font-size:28px; color:White" class="fa fa-rss" ></i></a>
    </p>
  </div>
</footer>

<script src="/assets/js/jquery.min.js"></script>
<script src="/assets/js/bootstrap.min.js"></script>

  
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-108363583-1"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());
	  gtag('config', 'UA-108363583-1');
	</script>




</body>
</html>
